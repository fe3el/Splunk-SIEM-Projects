<img width="1909" height="746" alt="Screenshot 2025-11-13 094425" src="https://github.com/user-attachments/assets/c325f263-f0e7-4e80-b267-91a86f8fe6b7" /># Analyzing DNS Log Files Using Splunk SIEM
## Introduction
The **Domain Name System (DNS)** plays a fundamental role in translating domain names into IP addresses, enabling communication across the internet. Because nearly all network activities rely on DNS, its logs provide valuable insights into how systems interact both internally and externally. DNS logging is therefore essential for monitoring network behavior, troubleshooting issues, and detecting suspicious or malicious activities such as DNS tunneling, data exfiltration, or command-and-control communications.

In this repository, I explore how to analyze DNS logs using Splunk search commands and simple **statistical scripting**, such as identifying the top values, performing count operations, and analyzing specific fields within raw DNS data to gain a deeper understanding of network activities.

## Steps to Upload Sample DNS Log Files to Splunk SIEM
### 1. Prepare Sample DNS Log Files
1. Obtain sample dummy DNS log filei n a suitable format (e.g., text files). from Open Source : (https://github.com/0xrajneesh)
2. Save the sample log files in a directory accessible by the Splunk instance.

### 2. Upload Log Files to Splunk
- Log in to the Splunk web interface (localhost:/8000).
- Navigate to **Add Data**.
- Select **Upload** as the data input method.

### 3. Choose File
- Click on **Select File** and choose the sample DNS log file we downloaded earlier.
  <img width="1910" height="889" alt="Screenshot 2025-11-13 090235" src="https://github.com/user-attachments/assets/66f2afd5-4218-4e6d-85cd-a659a1a0d107" />
- We can see the preview of the data after we uploaded it 

### 4. Set Source Type
- In the **Set Source Type** section, specify the source type for the uploaded log file.
  <img width="604" height="420" alt="Screenshot 2025-11-13 091528" src="https://github.com/user-attachments/assets/68f8d64f-eebd-4b50-a012-efcb028f09e7" />
- In this example i will be using "DNS_Log" for my source type know ,for later we can search the data using this Source Type

### 5. Set Index (Optional)
- We can choose to **Set Index** if we want. The index in Splunk is where all log data is stored and organised.
- It helps searches run faster because Splunk only looks in the right place.
<img width="868" height="203" alt="Screenshot 2025-11-13 091622" src="https://github.com/user-attachments/assets/165b072e-7917-4bff-b16d-252df0235820" />
- In this case, we let the index by default

### 6. Click Upload
- Review other settings such as index, host, and sourcetype.
- Ensure the settings are configured correctly to match the sample DNS log file.
<img width="534" height="188" alt="Screenshot 2025-11-13 091811" src="https://github.com/user-attachments/assets/7234601a-c836-4644-8e42-d60be3b56f47" />

### 7. Verify Upload
- After uploading, navigate to the search bar in the Splunk interface.
<img width="1911" height="810" alt="Screenshot 2025-11-13 091854" src="https://github.com/user-attachments/assets/eae94ce9-b93c-4a4c-9293-f648581f9a3e" />


## Analyze DNS Log Files in Splunk SIEM

### 1. Extract New Fields
- We can add another fields that might be useful
- Extracting new fields helps Splunk identify specific parts of the raw log that were not automatically parsed.
<img width="256" height="271" alt="Screenshot 2025-11-13 091854 (2)" src="https://github.com/user-attachments/assets/dfe8e28b-b67a-4c72-95cf-4521e62bffaa" />

- We can create a New fields b y clicking **Extract New Fields** On the left bar
<img width="1909" height="746" alt="Screenshot 2025-11-13 094425" src="https://github.com/user-attachments/assets/2f464605-a8c9-4022-8e7b-df7ffdc9d398" />
- In this case i created a new fields which : Source Address, Destination Address, Fully Qualified Domain Name, and Port. (We do it by blocking on the data)

### 2. Extract Relevant Fields
- Identify key fields in DNS logs such as source IP, destination IP, domain name, query type, response code, etc.   
- As mentioned below,  | regex _raw="(?i)\b(dns|fqdn|src_ip |dst_ip|port 53)\b": This regex searches for common DNS-related keywords in the raw event data.
- Example extraction command:
```
index=* sourcetype="DNS_Log"| regex _raw="(?i)\b(dns|fqdn|src_ip |dst_ip|port 53)\b"
```
### 3. Find the top DNS sources
- Use the top command to count the occurrences of each query type:   
```
index=* sourcetype=dns_sample | top fqdn
```
<img width="1917" height="681" alt="Screenshot 2025-11-13 094758" src="https://github.com/user-attachments/assets/34c38ef8-29d5-412b-a76c-ea4365564c4a" />


### 4. Counting by Destination IP Address 
- Look for unusual patterns or anomalies in DNS activity.
- Example query to identify spikes
```
index=_* OR index=* sourcetype=dns_sample  | stats count by dst_ip
```
<img width="1910" height="795" alt="Screenshot 2025-11-13 094933" src="https://github.com/user-attachments/assets/c7f8ffdb-d461-4f4a-84d5-8dd295ef4fb6" />

### 5. Analyze and Experimenting
- We can try some basic Splunk scripting to analyze the DNS log data.
- We can practice by finding Anomalies DNS or detect Source IP, etc
- Example search for known malicious domains:
```
index=* sourcetype=dns_sample fqdn="maliciousdomain.com"
```


## Conclusion
Analyzing DNS log files using Splunk SIEM enables security professionals to detect and respond to potential security incidents effectively. By understanding DNS activity and identifying anomalies, organizations can enhance their overall security posture and protect against various cyber threats.
### Lesson Learned
- How to Use Splunk
- Create New Fields From Raw Data
- Extract Relevant Fields
- Basic Statistic Splunk Commands 

   
