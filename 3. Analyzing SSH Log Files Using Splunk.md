# Analyzing SSH Log Files Using Splunk SIEM
## Introduction
**Secure Shell (SSH)** is a critical protocol used for remote system access and administration across networks. Because SSH provides direct access to servers, its log files are an essential source of information for detecting unauthorized access attempts, brute-force attacks, credential abuse, and other forms of malicious activity. Monitoring SSH traffic helps security teams understand login behavior, identify anomalies, and respond quickly to potential compromises.

## Steps to Upload Sample SSH Log Files to Splunk SIEM
### 1. Prepare Sample SSH Log Files
1. Obtain sample dummy SSH log file n a suitable format (e.g., text files). from Open Source : (https://github.com/0xrajneesh)
2. Save the sample log files in a directory accessible by the Splunk instance.

### 2. Upload Log Files to Splunk
- Log in to the Splunk web interface (localhost:/8000).
- Navigate to **Add Data**.
- Select **Upload** as the data input method.

### 3. Choose File
- Click on **Select File** and choose the sample SSH log file we downloaded earlier.
<img width="1917" height="921" alt="image" src="https://github.com/user-attachments/assets/70ac50ba-894c-4745-8300-21950e607398" />
- We can see the preview of the data after we uploaded it

### 4. Set Source Type
- In the **Set Source Type** section, specify the source type for the uploaded log file.
- In this case the Source type is set as _json

### 4. Set Source Type
- In the **Set Source Type** section, specify the source type for the uploaded log file.
- In this case the Source type is set as _json

### 5 Click Upload
- Once all settings are configured, click on the **Review** button.
- Click **Submit** to upload the sample SSH log file to Splunk.

### 6. Verify Upload
- After uploading, navigate to the search bar in the Splunk interface.
- Run a search query to verify that the uploaded SSH events are visible.


## Steps to Analyze SSH Log Files in Splunk SIEM
### 1. Search for SSH Events
- Open Splunk interface and navigate to the search bar.
- Enter the following search query to retrieve SSH events:
```
source="ssh_logs.json"  sourcetype="_json"
```
<img width="1914" height="924" alt="image" src="https://github.com/user-attachments/assets/ad57fba2-0243-4937-85f7-a9f63d43919b" />

### 2. Extract Relevant Fields
- Identify key fields in SSH logs such as timestamps, source IP addresses, usernames, actions, etc.
- Since our Data already in json Zeek SSH format, we dont need to extract features

### 3. Analyze SSH Activity Patterns
- Determine the distribution of SSH commands executed:
```
source="ssh_logs.json"  sourcetype="_json" | stats count by event_type
```

<img width="1917" height="655" alt="image" src="https://github.com/user-attachments/assets/76c121cd-21fe-44fd-82b6-32d030cd6ddf" />

- Identify top users or source IP addresses accessing the SSH server:

```
source="ssh_logs.json" sourcetype="_json" | top id.orig_p
```
<img width="1917" height="775" alt="image" src="https://github.com/user-attachments/assets/68e83800-fd8e-4103-b644-c336647f1ba7" />


- Analyze successful vs. failed SSH login attempts:
```
source="ssh_logs.json" sourcetype="_json" | stats count by auth_success
```
<img width="1917" height="666" alt="image" src="https://github.com/user-attachments/assets/23491f69-6fe9-4002-9f54-1fa93027e8d8" />

### 4. Detect Anomalies
- Analyze failed login attempts:
```
source="ssh_logs.json" sourcetype="_json" auth_success="false" | stats count by id.orig_h
```

<img width="1911" height="674" alt="image" src="https://github.com/user-attachments/assets/58fcdd77-d44b-4025-ae65-a0cb1eea4157" />

- Investigate SSH sessions from unusual or suspicious source IP addresses, Since in the top authentication failure are from 10.0.0.25:

```
source="ssh_logs.json" sourcetype="_json" auth_success="false" | search id.orig_h = "10.0.0.25"
```

<img width="1915" height="925" alt="image" src="https://github.com/user-attachments/assets/2fbc97d7-2795-47a8-b506-fd12372af6c2" />


## Conclusion
Analyzing SSH log files with Splunk SIEM offers deep visibility into remote server access across a network. By monitoring SSH activity, identifying unusual behavior, and correlating it with other log sources, organizations can strengthen their security posture and defend against unauthorized access and potential threats.

### Lesson Learned
- Understand How the SSH behaviour
- Understanding How the attacker behaviour (Lot of unsuccessfull auth, and auth attempts)
- More Statistic Splunk Commands 


