# Analyzing HTTP Log Files Using Splunk SIEM
## Introduction
**HTTP** is the main protocol for web communication. Since almost all web activity passes through HTTP, its logs are valuable for monitoring user behavior, troubleshooting issues, and detecting suspicious activity such as unauthorized access or unusual requests.

In this repository, I demonstrate how to analyze HTTP logs using Splunk, performing basic analysis such as counting top URLs, top user-agents, and status codes to understand traffic patterns and potential threats.

## Steps to Upload Sample HTTP Log Files to Splunk SIEM
### 1. Prepare Sample HTTP Log Files
1. Obtain sample dummy DNS log filei n a suitable format (e.g., text files). from Open Source : (https://github.com/0xrajneesh)
2. Save the sample log files in a directory accessible by the Splunk instance.

### 2. Upload Log Files to Splunk
- Log in to the Splunk web interface (localhost:/8000).
- Navigate to **Add Data**.
- Select **Upload** as the data input method.

### 3. Choose File
- Click on **Select File** and choose the sample HTTP log file we downloaded earlier.
<img width="1917" height="795" alt="image" src="https://github.com/user-attachments/assets/7bb9cdac-63f1-4b71-ae1d-980a65d4b9ee" />
- We can see the preview File after we selected the file

### 4. Set Source Type
- In the **Set Source Type** section, specify the source type for the uploaded log file.
- In this case the Source type is set as _json


### 5 Click Upload
- Once all settings are configured, click on the **Review** button.
- Click **Submit** to upload the sample HTTP log file to Splunk.

### 6. Verify Upload
- After uploading, navigate to the search bar in the Splunk interface.
- Run a search query to verify that the uploaded HTTP events are visible.

## Steps to Analyze HTTP Log Files in Splunk SIEM

### 1. Search for HTTP Events
- Open Splunk interface and navigate to the search bar.
- Enter the following search query to retrieve HTTP events:
```
index=* sourcetype=_json
```

### 2. Extract Relevant Fields
- Identify key fields in HTTP logs such as timestamps, request methods, URLs, response codes, user agents, etc.
- Use Splunk's field extraction capabilities or regular expressions to extract these fields for better analysis.
<img width="170" height="460" alt="image" src="https://github.com/user-attachments/assets/b486e2d0-dd1b-4d42-b350-4b961d4e6a77" />

- In this case the fields are already extracted to needed


### 3. Analyze Web Traffic
- Determine the distribution of request methods (GET, POST, etc.) to understand web traffic patterns.
```
index=* source="http_logs.json" sourcetype="_json" | stats count by method
```
<img width="1913" height="536" alt="image" src="https://github.com/user-attachments/assets/02b82d0b-cf98-4547-a807-b2db30bde04c" />

- Identify top URLs or endpoints accessed by users.
```
index=* source="http_logs.json" sourcetype="_json" | top uri
```
<img width="1901" height="430" alt="image" src="https://github.com/user-attachments/assets/e2b63a0b-c6c2-4acc-884e-dce4dca2c1b1" />

- Analyze response codes to identify errors or successful requests.
```
index=* source="http_logs.json" sourcetype="_json" | stats count by status_code
```
<img width="1916" height="446" alt="image" src="https://github.com/user-attachments/assets/a7886dee-ed82-4d40-97a4-db00132fc628" />

### 4. Detecting Anomalies
- Look for unusual patterns in file transfer activity by specific time

```
index=* source="http_logs.json" sourcetype="_json" | timechart span=1h count by status_code
```
<img width="1916" height="347" alt="image" src="https://github.com/user-attachments/assets/4e8acafc-1e6e-400a-851f-456f9322599a" />

- Analyze high volumes of error responses:

```
index=* source="http_logs.json" sourcetype="_json" 
| stats count by status_code 
| where status_code > 400
```
<img width="1909" height="337" alt="image" src="https://github.com/user-attachments/assets/a0b77d88-bfb2-4226-9655-1af7d54ef095" />

- Investigate file transfers to or from suspicious IP addresses. By searching who does a lot of errors

```
index=* source="http_logs.json" sourcetype="_json" status_code<400 | top id.orig_h   
```
<img width="1914" height="598" alt="image" src="https://github.com/user-attachments/assets/b2a40bc7-6de7-4c5b-b707-7768be20b219" />

### 5. Monitor User Behaviour
- Identify users using an uncommon browser

```
index=* source="http_logs.json" sourcetype="_json" 
| where NOT user_agent IN ("Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)", "Mozilla/5.0 (Windows NT 10.0; Win64; x64)", "Mozilla/5.0 (X11; Linux x86_64)") 
```
<img width="1913" height="801" alt="image" src="https://github.com/user-attachments/assets/0eea3340-d888-42e3-886a-608736c8795c" />

## Conclusion
Analyzing HTTP log files using Splunk SIEM enables security teams to identify unusual web activity, detect potential attacks, and respond to security incidents more effectively. By monitoring HTTP behavior and recognizing anomalies, organizations can strengthen their security posture and protect their web infrastructure from various cyber threats.

### Lesson Learned
- Generating Data by Time
- Creating Where Clause, Aggregation, etc
- More Statistic Splunk Commands 

### Problems
- Still Confuse about Regex command

  
  




